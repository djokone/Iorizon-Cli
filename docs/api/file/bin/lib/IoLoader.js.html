<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">bin/lib/IoLoader.js | iorizon-cli</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="Command line tools to set workflow"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="iorizon-cli"><meta property="twitter:description" content="Command line tools to set workflow"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  </ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">bin/lib/IoLoader.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">var Loader = require(&apos;./Loader&apos;)
var aliasLoader = require(&apos;./AliasLoader&apos;)
var ModuleLoader = require(&apos;./ModuleLoader&apos;)
var OptionsLoader = require(&apos;./OptionsLoader&apos;)
var reg = require(&apos;./ioRegex&apos;)
var resolve = require(&apos;path&apos;).resolve
var isEmpty = require(&apos;lodash/isEmpty&apos;)
var color = require(&apos;chalk&apos;)

class IoLoader extends Loader {
  constructor (ioConf = false, isGlobal = false, autoRun = false) {
    if (ioConf === false) {
      super()
    } else {
      super(ioConf)
    }
    this.ioConf = ioConf
    this.isGlobal = isGlobal
    // console.log(__dirname)
    this.Loaders = {}
    this._child = {}
    this._options = false
    this.argv = false
    if (typeof this.content.options !== &apos;undefined&apos;) {
      this._options = new OptionsLoader(this.content.options)
    }
    if (typeof this.content.alias !== &apos;undefined&apos; &amp;&amp; this.content.alias) {
      this.alias = new aliasLoader(this.content.alias)
    }
    if (typeof this.content.modules !== &apos;undefined&apos;) {
      this.modules = new ModuleLoader(this.content.modules, this.alias)
    }
    // if (autoRun) {
    //   this.runModule()
    // }
    // console.log(this.hasChildProcess)
    // if (this.hasChildProcess) {
    //   this.child = process.argv[2]
    //   this.globalPath = process.argv[2]
    //   // console.log(process.argv)
    //   process.argv.splice(2, 1)
    // } else {
    //   this.globalPath = process.argv[1]
    // }
  }
  static absolutePathReg () {
    return this.absolutePathReg
  }
  get options () {
    let options = {}
    this._options.each((v, k) =&gt; {
      let opt = this._options.get(v)
      options[opt.meta.option.name] = opt.value
      if (reg.alias.test(opt.value)) {
        options[opt.meta.option.name] = this.alias.parseUrl(opt.value)
      }
    })
    return options
  }
  get child () {
    return this._child
  }
  set argv (val) {
    if (val) {
      if (typeof this.modules !== &apos;undefined&apos;) {
        this.modules.argv = val
      }
    }
  }
  set child (value) {
    this._child = {
      ioConfPath: resolve(value, &apos;../../io.json&apos;),
      path: value
      // IoLoader: new IoLoader(resolve(value, &apos;../../&apos;))
    }
  }
  get hasChildProcess () {
    return this.absolutePathReg.test(process.argv[2])
  }
  runModule (module) {
    this.modules.run(module)
  }
  get name () {
    if (typeof this.content === &apos;undefined&apos; || typeof this.content.name === &apos;undefined&apos;) {
      console.warn(color.blue(&apos;Don\&apos;t forget to add a name to your io conf file&apos;))
      return &quot;unknow&quot;
    } else if (typeof this._name !== &apos;undefined&apos;) {
      return this._name
    } else {
      return this.content.name
    }
  }
}

module.exports = IoLoader
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.0.4)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
